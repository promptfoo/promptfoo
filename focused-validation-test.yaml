description: 'Focused test to validate the fix works and no regressions'

prompts:
  - 'Please use the get_weather function to get the weather for San Francisco, California.'

providers:
  # The original broken model - should now work
  - id: openrouter:qwen/qwen3-235b-a22b-thinking-2507
    config:
      temperature: 0.1
      showThinking: false
      max_tokens: 1024
      tool_choice: auto
      apiKeyEnvar: OPENROUTER_API_KEY
      apiBaseUrl: https://openrouter.ai/api/v1
      tools:
        - type: function
          function:
            name: get_weather
            description: Get weather information for a location
            parameters:
              type: object
              properties:
                location:
                  type: string
                  description: The location to get weather for
              required: ['location']

  # Test Gemini (original target for the code)
  - id: openrouter:google/gemini-2.5-pro
    config:
      temperature: 0.1
      showThinking: false
      max_tokens: 1024
      tool_choice: auto
      apiKeyEnvar: OPENROUTER_API_KEY
      apiBaseUrl: https://openrouter.ai/api/v1
      tools:
        - type: function
          function:
            name: get_weather
            description: Get weather information for a location
            parameters:
              type: object
              properties:
                location:
                  type: string
                  description: The location to get weather for
              required: ['location']

  # Test another working model for comparison
  - id: openrouter:qwen/qwen3-coder
    config:
      temperature: 0.1
      showThinking: false
      max_tokens: 1024
      tool_choice: auto
      apiKeyEnvar: OPENROUTER_API_KEY
      apiBaseUrl: https://openrouter.ai/api/v1
      tools:
        - type: function
          function:
            name: get_weather
            description: Get weather information for a location
            parameters:
              type: object
              properties:
                location:
                  type: string
                  description: The location to get weather for
              required: ['location']

tests:
  - description: All models should return tool calls without thinking when showThinking is false
    assert:
      - type: contains
        value: 'function'
      - type: not-contains
        value: 'Thinking:'
      - type: not-contains
        value: 'reasoning'
      - type: not-contains
        value: 'I need to'
      - type: not-contains
        value: 'Let me'
