# Edge cases and error handling test configuration
# Tests robustness, error recovery, and boundary conditions

providers:
  - id: 'file://./test-scripts/error_test.py:call_api'
    label: persistent-error-prone
    config:
      persistent: true

  - id: 'file://./test-scripts/error_test.py:call_api'
    label: traditional-error-prone
    config:
      persistent: false

  - id: 'file://./test-scripts/unicode_test.py:call_api'
    label: persistent-unicode
    config:
      persistent: true

  - id: 'file://./test-scripts/memory_test.py:call_api'
    label: persistent-memory-intensive
    config:
      persistent: true

prompts:
  # Error handling tests
  - 'trigger_runtime_error'
  - 'trigger_import_error'
  - 'trigger_timeout_simulation'
  - 'trigger_memory_error_simulation'
  - 'trigger_json_serialization_error'

  # Unicode and encoding tests
  - 'process_unicode: 擔먼봏疸뒪뎳 游깴 칠mojis 침치침칩'
  - "handle_special_chars: \n\t\r\\\"'"
  - "binary_data_simulation: \x00\x01\x02\x03"

  # Large input tests
  - 'process_large_input: {{large_text}}'

  # Memory pressure tests
  - 'allocate_large_memory: 10MB'
  - 'create_many_objects: 10000'

  # Function signature edge cases
  - 'test_no_args_function'
  - 'test_kwargs_function'
  - 'test_mixed_args_function'

tests:
  # Error recovery tests
  - vars:
      prompt: 'trigger_runtime_error'
    assert:
      - type: contains
        value: 'error'
      - type: not-contains
        value: 'fatal' # Should not be fatal

  - vars:
      prompt: 'trigger_import_error'
    assert:
      - type: contains
        value: 'error'

  # Unicode handling
  - vars:
      prompt: 'process_unicode: 擔먼봏疸뒪뎳 游깴 칠mojis 침치침칩'
    assert:
      - type: not-contains
        value: 'error'
      - type: contains
        value: 'unicode'

  # Memory tests
  - vars:
      prompt: 'allocate_large_memory: 10MB'
    assert:
      - type: not-contains
        value: 'fatal'
      - type: latency
        threshold: 15000

  # Large input test
  - vars:
      prompt: 'process_large_input: {{large_text}}'
      large_text: '{{range 1000}}This is a very long string that will be repeated many times to test how the system handles large inputs. {{end}}'
    assert:
      - type: latency
        threshold: 20000

defaultTest:
  assert:
    - type: latency
      threshold: 30000 # Extended timeout for edge cases

env:
  PYTHONPATH: './test-scripts'
