{
  "evalId": "eval-Lj0-2025-09-09T03:33:39",
  "results": {
    "version": 3,
    "timestamp": "2025-09-09T03:33:39.944Z",
    "prompts": [
      {
        "raw": "{{prompt}}",
        "label": "{{prompt}}",
        "id": "effa18501e44aafd9bc42a2f64ffc9b6350f94025520ca2ed382f9bdc4b6e982",
        "provider": "http://localhost:8000/run",
        "metrics": {
          "score": 2,
          "testPassCount": 2,
          "testFailCount": 1,
          "testErrorCount": 0,
          "assertPassCount": 2,
          "assertFailCount": 1,
          "totalLatencyMs": 4568,
          "tokenUsage": {
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "total": 0,
            "numRequests": 3,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0
        }
      }
    ],
    "results": [
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains",
                "value": "New York"
              }
            }
          ],
          "assertion": null
        },
        "id": "3611a923-9db1-4ccf-8013-8476af12b5cf",
        "latencyMs": 1628,
        "namedScores": {},
        "prompt": {
          "raw": "What's the weather in New York?",
          "label": "{{prompt}}"
        },
        "promptId": "effa18501e44aafd9bc42a2f64ffc9b6350f94025520ca2ed382f9bdc4b6e982",
        "promptIdx": 0,
        "provider": {
          "id": "http://localhost:8000/run",
          "label": ""
        },
        "response": {
          "raw": "[{\"content\":{\"parts\":[{\"thoughtSignature\":\"CusBAdHtim-kTZ6-QkchKvepXCOri1YBLy_0hT67YCq1eVbB6QU6NTrvMasdHoCJrs0HDtzMqx77x5IMh2YOLrYfYgShSr6Ex-Do90ovHoLUWWWuK6BKfS6YxmiwaBZuuryi5MAOZkLMOCwCmL8PHSuqhKE8DdmZkvWR69TyTxdYNDWL9YAqvsJt6fj-T6kDWiZBYnxF5TYLCNiiX58UTAVT-LYpHVGKlF8jkSzrXLBKWRGOfwF9iff-UG7IBq46VOeXzLOSYC0_ekRpCcTLbcsPBMU-ER4JUPfM-seoc9FFxg7rjgfiGFvLK_M_pw==\",\"functionCall\":{\"id\":\"adk-d9a845d4-2e11-45b3-830d-7b4db41652ea\",\"args\":{\"city\":\"New York\"},\"name\":\"get_weather\"}}],\"role\":\"model\"},\"usageMetadata\":{\"candidatesTokenCount\":16,\"promptTokenCount\":231,\"promptTokensDetails\":[{\"modality\":\"TEXT\",\"tokenCount\":231}],\"thoughtsTokenCount\":55,\"totalTokenCount\":302},\"invocationId\":\"e-effbb10c-e979-4c00-b754-90e2ff64578e\",\"author\":\"weather_agent\",\"actions\":{\"stateDelta\":{},\"artifactDelta\":{},\"requestedAuthConfigs\":{}},\"longRunningToolIds\":[],\"id\":\"f16413ee-e692-43b5-9633-956e69bdc071\",\"timestamp\":1757388819.994922},{\"content\":{\"parts\":[{\"functionResponse\":{\"id\":\"adk-d9a845d4-2e11-45b3-830d-7b4db41652ea\",\"name\":\"get_weather\",\"response\":{\"status\":\"success\",\"report\":\"The weather in New York is sunny with a temperature of 72°F (22°C). Light breeze from the west.\"}}}],\"role\":\"user\"},\"invocationId\":\"e-effbb10c-e979-4c00-b754-90e2ff64578e\",\"author\":\"weather_agent\",\"actions\":{\"stateDelta\":{},\"artifactDelta\":{},\"requestedAuthConfigs\":{}},\"id\":\"73c7a3c4-385f-477e-9da3-8223bc0be93b\",\"timestamp\":1757388820.915749},{\"content\":{\"parts\":[{\"text\":\"It's sunny in New York with a temperature of 72°F (22°C). There's a light breeze from the west. Enjoy your day!\\n\"}],\"role\":\"model\"},\"usageMetadata\":{\"candidatesTokenCount\":36,\"promptTokenCount\":294,\"promptTokensDetails\":[{\"modality\":\"TEXT\",\"tokenCount\":294}],\"totalTokenCount\":330},\"invocationId\":\"e-effbb10c-e979-4c00-b754-90e2ff64578e\",\"author\":\"weather_agent\",\"actions\":{\"stateDelta\":{},\"artifactDelta\":{},\"requestedAuthConfigs\":{}},\"id\":\"591450ec-8de0-438e-b7a3-ffab5527e83d\",\"timestamp\":1757388820.917884}]",
          "metadata": {
            "http": {
              "status": 200,
              "statusText": "OK",
              "headers": {
                "content-length": "1966",
                "content-type": "application/json",
                "date": "Tue, 09 Sep 2025 03:33:39 GMT",
                "server": "uvicorn"
              }
            }
          },
          "output": "It's sunny in New York with a temperature of 72°F (22°C). There's a light breeze from the west. Enjoy your day!",
          "tokenUsage": {
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "total": 0,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "Initial weather query",
          "vars": {
            "prompt": "What's the weather in New York?"
          },
          "assert": [
            {
              "type": "contains",
              "value": "New York"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "prompt": "What's the weather in New York?"
        },
        "metadata": {
          "http": {
            "status": 200,
            "statusText": "OK",
            "headers": {
              "content-length": "1966",
              "content-type": "application/json",
              "date": "Tue, 09 Sep 2025 03:33:39 GMT",
              "server": "uvicorn"
            }
          },
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains",
                "value": "London"
              }
            }
          ],
          "assertion": null
        },
        "id": "050e8c41-335a-4a24-bb56-d1d33c8937f7",
        "latencyMs": 1564,
        "namedScores": {},
        "prompt": {
          "raw": "How about London?",
          "label": "{{prompt}}"
        },
        "promptId": "effa18501e44aafd9bc42a2f64ffc9b6350f94025520ca2ed382f9bdc4b6e982",
        "promptIdx": 0,
        "provider": {
          "id": "http://localhost:8000/run",
          "label": ""
        },
        "response": {
          "raw": "[{\"content\":{\"parts\":[{\"thoughtSignature\":\"CvQBAdHtim_DuSMqeqUlbXqTH60h0cLd_l78inC42Jo6qSnv_w4CX7QVyJXBNJkCV1d0FepSME_08eaSw4gXBMiNE2r3bVFK4ODQELcTFF9ijOC8UxzwsMrxeEIXDHYEwpMi55zHMXVK7eAq4JhY1vnGmAMzQ9OSLn7W3CsNnG7WySETmIv1WVPek5TczBZ0t7ECKnYPPJwkdQiXT7sJDTAMp96qUNHfvj7paYVFzDvZTXeUxaMIgHcsUlWc-OUYFThmdQVgykYnIOIHaeQLuTcPlfebgE4FyjEKDZeJhwychiUTN8QrnsrQolxjichSRYIMCiH5Og==\",\"functionCall\":{\"id\":\"adk-07e7f685-bcd8-4121-85fd-7c2055bdef15\",\"args\":{\"city\":\"London\"},\"name\":\"get_weather\"}}],\"role\":\"model\"},\"usageMetadata\":{\"candidatesTokenCount\":15,\"promptTokenCount\":337,\"promptTokensDetails\":[{\"modality\":\"TEXT\",\"tokenCount\":337}],\"thoughtsTokenCount\":52,\"totalTokenCount\":404},\"invocationId\":\"e-3f6090cb-0418-4707-97e3-512fa439d672\",\"author\":\"weather_agent\",\"actions\":{\"stateDelta\":{},\"artifactDelta\":{},\"requestedAuthConfigs\":{}},\"longRunningToolIds\":[],\"id\":\"c7e30bf3-44cf-4522-9115-3bb5e61b09e8\",\"timestamp\":1757388824.642751},{\"content\":{\"parts\":[{\"functionResponse\":{\"id\":\"adk-07e7f685-bcd8-4121-85fd-7c2055bdef15\",\"name\":\"get_weather\",\"response\":{\"status\":\"success\",\"report\":\"The weather in London is cloudy with occasional drizzle. Temperature is 58°F (14°C).\"}}}],\"role\":\"user\"},\"invocationId\":\"e-3f6090cb-0418-4707-97e3-512fa439d672\",\"author\":\"weather_agent\",\"actions\":{\"stateDelta\":{},\"artifactDelta\":{},\"requestedAuthConfigs\":{}},\"id\":\"612afdfc-4f8b-43bc-b40d-23e4bfcad782\",\"timestamp\":1757388825.502417},{\"content\":{\"parts\":[{\"text\":\"In London, it's cloudy with occasional drizzle, and the temperature is 58°F (14°C). Don't forget your umbrella!\\n\"}],\"role\":\"model\"},\"usageMetadata\":{\"candidatesTokenCount\":33,\"promptTokenCount\":395,\"promptTokensDetails\":[{\"modality\":\"TEXT\",\"tokenCount\":395}],\"totalTokenCount\":428},\"invocationId\":\"e-3f6090cb-0418-4707-97e3-512fa439d672\",\"author\":\"weather_agent\",\"actions\":{\"stateDelta\":{},\"artifactDelta\":{},\"requestedAuthConfigs\":{}},\"id\":\"790d1393-7180-4994-b8ed-b84dd5ce8013\",\"timestamp\":1757388825.504441}]",
          "metadata": {
            "http": {
              "status": 200,
              "statusText": "OK",
              "headers": {
                "content-length": "1965",
                "content-type": "application/json",
                "date": "Tue, 09 Sep 2025 03:33:43 GMT",
                "server": "uvicorn"
              }
            }
          },
          "output": "In London, it's cloudy with occasional drizzle, and the temperature is 58°F (14°C). Don't forget your umbrella!",
          "tokenUsage": {
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "total": 0,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "Follow-up weather query",
          "vars": {
            "prompt": "How about London?"
          },
          "assert": [
            {
              "type": "contains",
              "value": "London"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "prompt": "How about London?"
        },
        "metadata": {
          "http": {
            "status": 200,
            "statusText": "OK",
            "headers": {
              "content-length": "1965",
              "content-type": "application/json",
              "date": "Tue, 09 Sep 2025 03:33:43 GMT",
              "server": "uvicorn"
            }
          },
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Expected output to match regex \"(New York|London)\"",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Expected output to match regex \"(New York|London)\"",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to match regex \"(New York|London)\"",
              "assertion": {
                "type": "regex",
                "value": "(New York|London)",
                "caseSensitive": false
              }
            }
          ],
          "assertion": null
        },
        "id": "760f7ac2-a2c9-4b7f-8a1b-7d1616bde57d",
        "latencyMs": 1376,
        "namedScores": {},
        "prompt": {
          "raw": "Which cities have we discussed so far?",
          "label": "{{prompt}}"
        },
        "promptId": "effa18501e44aafd9bc42a2f64ffc9b6350f94025520ca2ed382f9bdc4b6e982",
        "promptIdx": 0,
        "provider": {
          "id": "http://localhost:8000/run",
          "label": ""
        },
        "response": {
          "raw": "[{\"content\":{\"parts\":[{\"thoughtSignature\":\"CpEEAdHtim-1Kwx_UZKtQllacwKJm_alUpaSFUahpXR-9h8d57_mqht_Mz7fjprzI1uwgdpWFe9rCZa0PBIi11ela6q0wo7W2FhQ42fJKEV99xKV2WWxsJ8ZCxTWyJYl80jEREj0y7ULL4jJ4A0Us9L-8j_LJvUrxiXD344qg9zTKbFwxEXm_0aV_JPlB1dNtJaJtDONx2vLlrbVw4gQ-3KZfS2on_p71ROVtDdOlD7iByuZ1BCv4TNFp2GpwevQo0GECs5NL7I3hRAO88RpfPwcoV8Bp3bkIOKhlAlwt85ZeCNxoZTvEfxVTOvpj7CWNEimAyO2r_Os1RSGw7yjuVl5kQm51Xkh9UWyHDmk7TeAOI9gwjTooQkMYeWpQFlcvvdWq0mHYOZW7Fg_pQKaIPLxGpLLhRuQQk_-JpoYWP3XQNL8XpMVERvyLvOdOHLpl3jGcYBNtKFtEyoGqmffhmYMH5D_GgPkY4UnHBd04pFQzLXPG69dAluikkPS-ZkYr_jVndJWn9y0NJMAahUnssPDEa1cf8qBTqAwbgYKQDAI2t6awdkdBAJdt5HhbwHFtjVuKEFpyxPqUCFvzxxRw6jvsruVdb-5Snx4Ot5HTM02C64IGUBzG-EaBEO3qigrtdHuIqDAqGF-vGX6TVsscm2t3zY6zbC4PCwT2Uhm69VzospTf14FsAXHF0G4hur72Fq4mw==\",\"text\":\"I'm sorry, I can't recall the previous cities we've discussed. My purpose is to provide current weather information for individual cities. Is there another city's weather you'd like to know about?\"}],\"role\":\"model\"},\"usageMetadata\":{\"candidatesTokenCount\":45,\"promptTokenCount\":439,\"promptTokensDetails\":[{\"modality\":\"TEXT\",\"tokenCount\":439}],\"thoughtsTokenCount\":95,\"totalTokenCount\":579},\"invocationId\":\"e-fb891f19-8580-4910-85f6-42d0b87d11a8\",\"author\":\"weather_agent\",\"actions\":{\"stateDelta\":{},\"artifactDelta\":{},\"requestedAuthConfigs\":{}},\"id\":\"e098aecf-90d4-4e8c-9a0a-5e2dfc298fa7\",\"timestamp\":1757388829.223057}]",
          "metadata": {
            "http": {
              "status": 200,
              "statusText": "OK",
              "headers": {
                "content-length": "1384",
                "content-type": "application/json",
                "date": "Tue, 09 Sep 2025 03:33:48 GMT",
                "server": "uvicorn"
              }
            }
          },
          "output": "I'm sorry, I can't recall the previous cities we've discussed. My purpose is to provide current weather information for individual cities. Is there another city's weather you'd like to know about?",
          "tokenUsage": {
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "total": 0,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          }
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Memory test - recalls previous context",
          "vars": {
            "prompt": "Which cities have we discussed so far?"
          },
          "assert": [
            {
              "type": "regex",
              "value": "(New York|London)",
              "caseSensitive": false
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 2,
        "vars": {
          "prompt": "Which cities have we discussed so far?"
        },
        "metadata": {
          "http": {
            "status": 200,
            "statusText": "OK",
            "headers": {
              "content-length": "1384",
              "content-type": "application/json",
              "date": "Tue, 09 Sep 2025 03:33:48 GMT",
              "server": "uvicorn"
            }
          },
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      }
    ],
    "stats": {
      "successes": 2,
      "failures": 1,
      "errors": 0,
      "tokenUsage": {
        "prompt": 0,
        "completion": 0,
        "cached": 0,
        "total": 0,
        "numRequests": 3,
        "completionDetails": {
          "reasoning": 0,
          "acceptedPrediction": 0,
          "rejectedPrediction": 0
        },
        "assertions": {
          "total": 0,
          "prompt": 0,
          "completion": 0,
          "cached": 0,
          "numRequests": 0,
          "completionDetails": {
            "reasoning": 0,
            "acceptedPrediction": 0,
            "rejectedPrediction": 0
          }
        }
      }
    }
  },
  "config": {
    "tags": {},
    "description": "ADK multi-turn testing with conversation memory",
    "prompts": [
      "{{prompt}}"
    ],
    "providers": [
      {
        "id": "https",
        "config": {
          "url": "http://localhost:8000/run",
          "method": "POST",
          "headers": {
            "Content-Type": "application/json"
          },
          "body": {
            "app_name": "weather_agent",
            "user_id": "test_user",
            "session_id": "conversation",
            "new_message": {
              "role": "user",
              "parts": [
                {
                  "text": "{{prompt}}"
                }
              ]
            }
          },
          "transformResponse": "file://adk-response-transform.js"
        }
      }
    ],
    "tests": [
      {
        "description": "Initial weather query",
        "vars": {
          "prompt": "What's the weather in New York?"
        },
        "assert": [
          {
            "type": "contains",
            "value": "New York"
          }
        ]
      },
      {
        "description": "Follow-up weather query",
        "vars": {
          "prompt": "How about London?"
        },
        "assert": [
          {
            "type": "contains",
            "value": "London"
          }
        ]
      },
      {
        "description": "Memory test - recalls previous context",
        "vars": {
          "prompt": "Which cities have we discussed so far?"
        },
        "assert": [
          {
            "type": "regex",
            "value": "(New York|London)",
            "caseSensitive": false
          }
        ]
      }
    ],
    "scenarios": [],
    "env": {},
    "sharing": false,
    "outputPath": [
      "multi-turn-results.json"
    ],
    "extensions": [
      "file://adk-session-hook.js:adkSessionHook"
    ],
    "metadata": {},
    "evaluateOptions": {}
  },
  "shareableUrl": "https://www.promptfoo.app/eval/eval-Lj0-2025-09-09T03:33:39",
  "metadata": {
    "promptfooVersion": "0.118.3",
    "nodeVersion": "v22.14.0",
    "platform": "darwin",
    "arch": "arm64",
    "exportedAt": "2025-09-09T03:33:54.558Z",
    "evaluationCreatedAt": "2025-09-09T03:33:39.944Z"
  }
}