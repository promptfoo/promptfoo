# yaml-language-server: $schema=https://promptfoo.dev/config-schema.json

# Learn more about building a configuration: https://promptfoo.dev/docs/configuration/guide

description: 'Azure vs OpenAI structured output'

# Define the response format schema that will be reused
definitions:
  math_response_format: &math_response_format
    type: json_schema
    json_schema:
      name: math_response
      strict: true
      schema:
        type: object
        properties:
          steps:
            type: array
            items:
              type: object
              properties:
                explanation:
                  type: string
                output:
                  type: string
              required:
                - explanation
                - output
              additionalProperties: false
          final_answer:
            type: string
        required:
          - steps
          - final_answer
        additionalProperties: false

prompts:
  - 'You are a helpful math tutor. Solve {{problem}}'
providers:
  - id: azure:chat:gpt-4o-2
    config:
      apiHost: 'promptfoo.openai.azure.com'
      apiVersion: '2024-08-01-preview'
      deploymentName: 'gpt-4o-2'
      response_format: *math_response_format
  - id: openai:chat:gpt-4o-2024-08-06
    config:
      response_format: *math_response_format
tests:
  - vars:
      problem: '8x + 31 = 2'
  - vars:
      problem: 'sqrt(x) = 4.9'
