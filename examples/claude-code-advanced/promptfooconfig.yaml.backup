# yaml-language-server: $schema=https://promptfoo.dev/config-schema.json
description: 'Claude Code with file modifications and git-based cleanup'

prompts:
  - 'Refactor the auth.js file to use async/await patterns'

providers:
  - id: claude-code
    config:
      working_dir: ./workspace
      append_allowed_tools: ['Write', 'Edit', 'MultiEdit']
      permission_mode: 'acceptEdits'

# Demonstrate git-based cleanup strategy from docs
hooks:
  afterEach: |
    const { execSync } = require('child_process');
    execSync('git reset --hard HEAD', { cwd: './workspace' });

tests:
  - vars: {}
    assert:
      - type: llm-rubric
        value: 'Should refactor code to use async/await patterns'
      - type: llm-rubric
        value: 'Should add proper error handling'