# yaml-language-server: $schema=https://promptfoo.dev/config-schema.json
description: E2E test for video-rubric with OpenAI Sora 2

prompts:
  - '{{prompt}}'

providers:
  - id: openai:video:sora-2
    config:
      size: '1280x720'
      seconds: 4

# Use Vertex AI (Gemini) for video grading since it supports video understanding
# Requires: gcloud auth application-default login
defaultTest:
  options:
    provider:
      id: vertex:gemini-2.5-flash
      config:
        generationConfig:
          response_mime_type: application/json

tests:
  - vars:
      prompt: A golden retriever running on a beach at sunset with waves in the background
    assert:
      - type: video-rubric
        # Override grading provider to use Vertex AI Gemini
        provider: vertex:gemini-2.5-flash
        value: |
          Evaluate the video based on the following criteria:
          1. Subject: A dog (golden retriever or similar) should be visible
          2. Setting: Beach or shoreline with ocean/waves visible
          3. Motion: The dog should be running or moving
          4. Lighting: Warm sunset colors should be present
          Score 1.0 if all criteria are met, 0.5 if partially met, 0.0 if none are met.
          Return JSON with fields: pass (boolean), score (number 0-1), reason (string).
