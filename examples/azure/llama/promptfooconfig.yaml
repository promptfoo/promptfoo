# yaml-language-server: $schema=https://promptfoo.dev/config-schema.json

description: Azure Llama models

prompts:
  - |
    You are a helpful coding assistant.

    Write a {{language}} function that {{task}}.
    Include comments explaining the code.

providers:
  - id: azure:chat:Llama-3.3-70B-Instruct
    label: llama-3.3-70b
    config:
      apiHost: '{{ env.AZURE_AI_HOST }}'
      apiVersion: '2025-04-01-preview'
      max_tokens: 2048
      temperature: 0.3

  - id: azure:chat:Meta-Llama-3.1-8B-Instruct
    label: llama-3.1-8b
    config:
      apiHost: '{{ env.AZURE_AI_HOST }}'
      apiVersion: '2025-04-01-preview'
      max_tokens: 2048
      temperature: 0.3

tests:
  - vars:
      language: Python
      task: calculates the factorial of a number using recursion
    assert:
      - type: contains
        value: 'def'
      - type: contains-any
        value: ['factorial', 'recursion', 'recursive']
      - type: python
        value: |
          def test_code():
              # Check for function definition and recursive call
              return 'def ' in output and ('return' in output or 'factorial' in output)
          test_code()

  - vars:
      language: JavaScript
      task: reverses a string without using built-in reverse methods
    assert:
      - type: contains
        value: 'function'
      - type: not-contains
        value: '.reverse()'

  - vars:
      language: Python
      task: checks if a number is prime
    assert:
      - type: contains
        value: 'def'
      - type: contains-any
        value: ['prime', 'divisible', 'modulo', '%']
