description: 'Anthropic Web Research example - demonstrates Claude using web search and web fetch together for comprehensive research'

providers:
  - id: anthropic:messages:claude-opus-4-1-20250805
    config:
      temperature: 0.1
      max_tokens: 4096
      tools:
        - type: web_search_20250305
          name: web_search
          max_uses: 3
        - type: web_fetch_20250910
          name: web_fetch
          max_uses: 5
          allowed_domains:
            - docs.anthropic.com
            - github.com
            - arxiv.org
            - openai.com
            - huggingface.co
            - papers.nips.cc
          citations:
            enabled: true
          max_content_tokens: 20000

prompts:
  - |
    Research the topic "{{topic}}" and provide a comprehensive report.
    
    Instructions:
    1. First search for recent information about the topic
    2. Identify the most relevant and authoritative sources
    3. Fetch full content from the best sources
    4. Synthesize the information into a well-structured report
    5. Include citations for all claims and facts
    
    The report should include:
    - Executive summary
    - Key findings
    - Recent developments
    - Future outlook (if applicable)
    - Sources and references

tests:
  - vars:
      topic: 'Claude 4 AI model capabilities'
    assert:
      - type: contains
        value: 'Claude'
      - type: llm-rubric
        value: 'The response should provide a comprehensive research report with multiple sources and proper citations'
      - type: llm-rubric
        value: 'The response should be well-structured with clear sections and executive summary'

  - vars:
      topic: 'web fetch tool security considerations'
    assert:
      - type: contains-any
        value: ['security', 'exfiltration', 'domain filtering']
      - type: llm-rubric
        value: 'The response should discuss security aspects of web fetching tools'

  - vars:
      topic: 'latest developments in AI tool use'
    assert:
      - type: contains-any
        value: ['tool', 'function', 'API']
      - type: llm-rubric
        value: 'The response should cover recent developments in AI tool usage and function calling'