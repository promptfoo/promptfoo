description: 'Combined Web Search + Fetch test'

providers:
  - id: anthropic:messages:claude-sonnet-4-20250514
    config:
      temperature: 0.1
      max_tokens: 2048
      tools:
        - type: web_search_20250305
          name: web_search
          max_uses: 2
        - type: web_fetch_20250910
          name: web_fetch
          max_uses: 3
          allowed_domains:
            - docs.anthropic.com
            - github.com
            - openai.com
            - huggingface.co
          citations:
            enabled: true
          max_content_tokens: 10000

prompts:
  - |
    Research the latest developments in Claude 4 AI models. 
    
    Please:
    1. Search for recent information about Claude 4
    2. Fetch detailed content from the most relevant sources
    3. Provide a summary of key capabilities and improvements
    4. Include proper citations

tests:
  - assert:
      - type: contains-any
        value: ['Claude 4', 'claude-4', 'capabilities', 'improvements']
        reason: 'Response should mention Claude 4 and its features'
      - type: llm-rubric
        value: 'The response should provide a comprehensive research summary based on multiple sources'
      - type: contains-any
        value: ['search', 'found', 'according', 'based on', 'research', 'sources']
        reason: 'Response should indicate research was performed'