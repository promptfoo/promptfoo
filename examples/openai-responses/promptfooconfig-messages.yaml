# Example: Using messages format with markdown formatting transform
#
# This example demonstrates:
# 1. Using 'messages:' format to construct prompts
# 2. Applying a transform to format message arrays as readable markdown
# 3. Viewing response metadata (responseId, model) in the UI

description: 'OpenAI Responses API - Messages Format with Transform'

prompts:
  - label: 'conversation'
    raw: |
      messages:
        - role: system
          content: You are a helpful assistant that provides concise answers.
        - role: user
          content: '{{question}}'

providers:
  - id: openai:responses:gpt-4o-2024-11-20
    label: 'GPT-4o (formatted)'
    config:
      # Transform converts message arrays to readable markdown
      transform: file://./format-messages.js

  - id: openai:responses:gpt-4o-2024-11-20
    label: 'GPT-4o (raw)'
    # No transform - shows raw JSON for comparison

tests:
  - vars:
      question: 'What is the capital of France?'
    assert:
      - type: llm-rubric
        value: 'mentions Paris'

  - vars:
      question: 'Explain quantum computing in one sentence.'
    assert:
      - type: llm-rubric
        value: 'provides a concise explanation'

  - vars:
      question: 'What are the three primary colors?'
    assert:
      - type: contains-any
        value: ['red', 'blue', 'yellow']

# View results:
# 1. Run: npm run local -- eval -c examples/openai-responses/promptfooconfig-messages.yaml
# 2. View: npm run local -- view
# 3. Compare "formatted" vs "raw" outputs
# 4. Click any result â†’ Metadata tab to see responseId and model
