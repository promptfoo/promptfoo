# yaml-language-server: $schema=https://promptfoo.dev/config-schema.json
description: Custom metric naming and derivation for evaluation

prompts:
  - 'Say this as though you are a pirate: {{body}}'
  - 'Say this as though you are a seafarer from the 17th century: {{body}}'

providers:
  - echo  # Using echo provider for demonstration

derivedMetrics:
  - name: DoubleConsistency
    value: Consistency * 2

# Use defaultTest to apply a metric with a template variable
defaultTest:
  assert:
    - type: icontains
      value: '{{keyword}}'
      metric: '{{category}}'

tests:
  - description: Check for pirate tone with dynamic metric
    vars:
      body: Yarr, matey!
      keyword: yarr
      category: PirateTone
  
  - description: Check for hunger-related words with dynamic metric
    vars:
      body: I need some grub
      keyword: grub
      category: PirateTone

  - description: Check if output contains expected text
    vars:
      body: '{"message": "Hello"}'
      keyword: message
      category: FormatCheck
    assert:
      - type: is-json
        metric: Consistency

  - description: Check for greeting
    vars:
      body: Ahoy, world
      keyword: ahoy
      category: Greeting

  - description: Check for pirate-like language
    vars:
      body: The pirate spoke clearly
      keyword: pirate
      category: Tone


