description: Example showing how to override scoring functions
providers:
  - openai:gpt-4.1-mini
prompts:
  - >-
    Translate the following text to {{language}}: {{text}}.  IMPORTANT: Ensure
    the response is less than 100 characters
defaultTest:
  assert:
    - type: llm-rubric
      value: >-
        Rate the accuracy of the translation of {{text}} from English to
        {{language}}
      metric: accuracy
    - type: llm-rubric
      value: >-
        Rate the fluency of the translation of {{text}} from English to
        {{language}}
      metric: fluency
    - type: llm-rubric
      value: >-
        Rate the grammar of the translation of {{text}} from English to
        {{language}}
      metric: grammar
    - type: python
      metric: Length Limit
      value: |-
        # Remove leading/trailing whitespace
        output_stripped = output.strip()

        # Measure the length of the output (in Unicode code points)
        length = len(output_stripped)

        # Check if the output is fewer than 100 characters
        if length < 100:
            return {'pass': True, 'score': 1.0}
        return {'pass': False, 'score': 0.0}
    - type: llm-rubric
      metric: Language Output
      value: >-
        Is the translation provided in the target language specified in the
        prompt?
    - type: llm-rubric
      metric: Translation Accuracy
      value: >-
        Does the output preserve the original meaning of the input text when
        translated?
    - type: llm-rubric
      metric: No Extraneous Content
      value: >-
        Does the translated output exclude any additional comments,
        explanations, or metadata?
    - type: llm-rubric
      metric: No Source Text
      value: Does the response avoid including or repeating the original source text?
  options:
    provider:
      text: openai:gpt-4.1-mini
      embedding: openai:embedding:text-embedding-3-small
tests:
  - description: Default scoring function (geometric mean)
    vars:
      language: Spanish
      text: Hello, how are you today?
    assert:
      - type: similar
        value: Como estas?
        metric: similar
