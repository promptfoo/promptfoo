---
sidebar_position: 1
title: Image Evaluation with Replicate
description: Learn how to evaluate and compare image generation models using promptfoo and Replicate, through a practical t-shirt design workflow.
---

# Evaluating Image Generation with Replicate

Ever wondered how to streamline your image generation workflow? At promptfoo, we faced this challenge when designing t-shirts for our contributors and partner companies. Our mascot is a red panda (because who doesn't love red pandas?), and we needed a consistent process to generate multiple design variations, compare them, and pick the best ones. In this guide, we'll walk through setting up an image evaluation pipeline using promptfoo and Replicate's image models.

## Quick Start

```bash
# Initialize a new project with the Replicate FLUX example
promptfoo init --example replicate-flux

# Set your Replicate API token
export REPLICATE_API_TOKEN=your_token_here

# Run the evaluation
promptfoo eval
```

[Screenshot: Initial evaluation results showing a basic red panda design generated by FLUX Schnell]

## Why Image Evaluations Matter

When working with image generation models, consistency is key. You need to:

- Compare different models and their strengths
- Test various prompts and parameters
- Ensure consistent quality across multiple generations
- Track and version your image generation process

Let's see how to build this pipeline step by step.

## Building Our T-Shirt Design Pipeline

### Step 1: Basic Setup with One Model

Let's start with a simple configuration using FLUX Schnell for quick iterations:

```yaml
description: 'promptfoo T-Shirt Design Pipeline'

prompts:
  - 'Create a minimalist t-shirt design featuring {{design}} on a clean white background, perfect for screen printing'

providers:
  - id: replicate:black-forest-labs/flux-schnell
    config:
      go_fast: true
      num_inference_steps: 2
      megapixels: '1'
      aspect_ratio: '1:1'
      output_format: 'png'

tests:
  - vars:
      design: 'a cute red panda wearing programmer glasses and typing on a laptop'
```

This basic setup lets us quickly test if our pipeline works. Run it with:

```bash
promptfoo eval
```

[Screenshot: Single model output showing variations of the programmer red panda design at different seeds]

### Step 2: Adding a High-Quality Model

Now let's add FLUX Pro Ultra for higher quality outputs:

```yaml
providers:
  - id: replicate:black-forest-labs/flux-schnell
    config:
      go_fast: true
      num_inference_steps: 2
      megapixels: '1'
      aspect_ratio: '1:1'
      output_format: 'png'

  - id: replicate:black-forest-labs/flux-1.1-pro-ultra
    config:
      go_fast: false
      num_inference_steps: 4
      megapixels: '4'
      aspect_ratio: '1:1'
      output_format: 'png'
```

[Screenshot: Side-by-side comparison of the same red panda design generated by FLUX Schnell (left) vs FLUX Pro Ultra (right)]

### Step 3: Expanding Test Cases

Let's add more design variations:

```yaml
tests:
  - vars:
      design: 'a cute red panda wearing programmer glasses and typing on a laptop'
  - vars:
      design: 'a minimalist red panda face formed by curly braces and semicolons'
  - vars:
      design: 'a red panda debugging code, surrounded by floating error messages and coffee cups'
  - vars:
      design: 'a pixel art red panda wearing headphones and staring at terminal output'
```

[Screenshot: Grid view showing the four different red panda design variations, demonstrating the range from minimalist to detailed styles]

### Step 4: Refining the Prompt Template

Now we can make our prompt more specific:

```yaml
prompts:
  - 'Create a minimalist t-shirt design with {{design}}, ensuring the design is centered and works well on a white t-shirt. The design should be clean, professional, and suitable for screen printing. Use a color palette that emphasizes warm reds and oranges.'
  - 'Design a modern tech-themed t-shirt featuring {{design}}. The style should be bold and eye-catching while maintaining a professional look suitable for developer events. Incorporate our signature red panda colors.'
```

[Screenshot: Before/after comparison showing how the refined prompt template improves the design output, particularly in color usage and composition]

### Step 5: Fine-tuning Parameters

Let's optimize our model configurations:

```yaml
providers:
  - id: replicate:black-forest-labs/flux-schnell
    config:
      go_fast: true
      num_inference_steps: 2
      megapixels: '1'
      aspect_ratio: '1:1'
      output_format: 'png'
      seed: 42 # For reproducibility

  - id: replicate:black-forest-labs/flux-1.1-pro-ultra
    config:
      go_fast: false
      num_inference_steps: 4
      megapixels: '4'
      aspect_ratio: '1:1'
      output_format: 'png'
      seed: 42 # For reproducibility
```

[Screenshot: Parameter tuning results showing how different megapixel and step settings affect the final design quality]

## Tips for Effective Image Evaluation

1. **Use Consistent Seeds**: Set fixed seeds when you want to compare prompt changes without model variance.

2. **Start Fast, Finish Strong**: Use faster models like FLUX Schnell for initial iterations, then switch to higher quality models for final versions.

3. **Mind the Format**:

   - Use `png` for final outputs to avoid compression artifacts
   - Use `webp` for faster iteration and preview
   - Consider aspect ratio based on your printing requirements

4. **Prompt Structure**:

   - Start with placement ("centered", "full-width")
   - Specify style ("minimalist", "detailed", "cartoon")
   - Include medium-specific details ("suitable for screen printing")
   - Add color preferences if any
   - Mention background requirements

5. **Batch Processing**:
   ```yaml
   evaluateOptions:
     maxConcurrency: 2
     delay: 1000
   ```

[Screenshot: promptfoo's evaluation interface showing the comparison matrix of different models and prompts]

## Our Current Workflow

1. Generate 3-4 variations using FLUX Schnell
2. Pick promising designs and regenerate with FLUX Pro Ultra
3. Fine-tune prompts for selected designs
4. Generate final versions with fixed seeds
5. Export results for review

[Screenshot: Final production workflow showing the progression from initial FLUX Schnell concepts to final FLUX Pro Ultra renders]

## Next Steps

- Try different models like Stable Diffusion or Midjourney
- Add automated size and color variations
- Implement prompt variables for brand colors and themes
- Set up automated exports for your preferred printing service

## Complete Example

Here's our production configuration:

```yaml
description: 'promptfoo T-Shirt Design Pipeline'

prompts:
  - 'Create a minimalist t-shirt design with {{design}}, ensuring the design is centered and works well on a white t-shirt. The design should be clean, professional, and suitable for screen printing. Use a color palette that emphasizes warm reds and oranges.'
  - 'Design a modern tech-themed t-shirt featuring {{design}}. The style should be bold and eye-catching while maintaining a professional look suitable for developer events. Incorporate our signature red panda colors.'

providers:
  - id: replicate:black-forest-labs/flux-schnell
    config:
      go_fast: true
      num_inference_steps: 2
      megapixels: '1'
      aspect_ratio: '1:1'
      output_format: 'png'
      seed: 42

  - id: replicate:black-forest-labs/flux-1.1-pro-ultra
    config:
      go_fast: false
      num_inference_steps: 4
      megapixels: '4'
      aspect_ratio: '1:1'
      output_format: 'png'
      seed: 42

tests:
  # Core promptfoo Designs
  - vars:
      design: 'a cute red panda wearing programmer glasses and typing on a laptop, with "promptfoo" in clean Helvetica font below'
  - vars:
      design: 'a minimalist red panda face formed by curly braces and semicolons, with "promptfoo" in modern sans-serif floating above'

  # NVIDIA Collaboration
  - vars:
      design: 'a red panda surfing on an NVIDIA GPU with neon green accents, "promptfoo" in bold futuristic sans-serif below, maintaining NVIDIA brand colors'

  # Microsoft Collaboration
  - vars:
      design: 'a red panda sitting in a Windows-style window frame, surrounded by floating Microsoft icons, with "promptfoo" in Segoe UI font, using Microsoft\'s official colors'

  # IBM Collaboration
  - vars:
      design: 'a red panda formed from IBM\'s 8-bar logo style in classic IBM blue, with "promptfoo" in IBM Plex Sans font below'

  # Google Collaboration
  - vars:
      design: 'a red panda playing with the Google dots, each dot a different Google brand color, "promptfoo" in Product Sans font with matching color gradient'

  # Meta Collaboration
  - vars:
      design: 'a red panda in Meta\'s infinity loop style, with subtle Meta gradient colors, "promptfoo" in Optimistic Display font below'

assertions:
  - type: llm-rubric
    value: |
      Evaluate the t-shirt design based on the following criteria:

      1. Brand Alignment (0-10):
         - Does it respect both promptfoo and partner brand guidelines?
         - Are brand colors used appropriately?
         - Is the typography consistent with brand standards?

      2. Design Composition (0-10):
         - Is the red panda clearly visible and well-integrated?
         - Is the "promptfoo" text legible and well-placed?
         - Does the design have good balance and visual hierarchy?

      3. Technical Quality (0-10):
         - Is the resolution sufficient for printing?
         - Are the edges clean and sharp?
         - Are the colors well-separated and print-ready?

      4. Creativity & Appeal (0-10):
         - Does it creatively merge both brand identities?
         - Would developers want to wear this?
         - Is it memorable and unique?

      5. Production Feasibility (0-10):
         - Can this be screen printed effectively?
         - Will the design work on different shirt colors?
         - Are the details preserved at different sizes?

      Total score: Sum of all categories (max 50 points)

      Provide specific feedback for each category and suggestions for improvement.

evaluateOptions:
  maxConcurrency: 2
  delay: 1000
```

This setup has helped us maintain consistency in our t-shirt design process while allowing for creative exploration. The combination of fast iteration and high-quality refinement lets us quickly move from concept to final design. Plus, who wouldn't want a coding red panda on their t-shirt?

Remember, the key to successful image evaluation is finding the right balance between iteration speed and output quality. Start fast, iterate quickly, and only move to high-quality (and slower) generations when you've narrowed down your design direction.

[Screenshot: A collection of our favorite generated t-shirt designs, showing the range of styles we've achieved]

6. **Brand Guidelines**:

   - Keep partner brand colors precise (e.g., NVIDIA green: #76B900)
   - Use correct brand fonts when specified
   - Maintain appropriate logo clearspace
   - Follow brand usage guidelines for modifications

7. **Typography Guidelines**:
   - "promptfoo" should always be in lowercase
   - Use sans-serif fonts for better readability
   - Maintain consistent text placement
   - Ensure text contrasts well with the background

## Refining the Evaluation Process

After running our initial tests, we noticed some interesting patterns. The NVIDIA design scored high on technical quality but needed work on creativity. The Google design nailed the brand alignment but struggled with production feasibility. Here's how we iteratively improved our process:

### 1. Analyzing the Results

Looking at our first batch of results:

[Screenshot: Evaluation matrix showing scores across different criteria]

We noticed that designs with explicit font instructions performed better. The IBM design scored particularly well because the prompt specified "IBM Plex Sans" and referenced the 8-bar logo style directly.

### 2. Improving the Prompts

Based on these insights, we updated our prompts to be more specific:

```yaml
prompts:
  - 'Create a {{style}} t-shirt design featuring a red panda {{action}}, with "promptfoo" in {{font}} positioned {{position}}. The design should use {{colors}} and maintain {{brand}} identity.'
```

With variables like:

```yaml
vars:
  style: ['minimalist', 'modern tech', 'playful professional']
  action: ['coding with determination', 'debugging with a smile', 'deploying with confidence']
  font: ['Helvetica Neue', 'IBM Plex Sans', 'Segoe UI']
  position: ['centered below', 'integrated within', 'floating above']
  colors: ['warm reds with accents of partner brand colors', 'partner brand colors with red panda highlights']
  brand: ['NVIDIA\'s gaming aesthetic', 'Microsoft\'s modern simplicity', 'IBM\'s enterprise confidence']
```

### 3. Refining the Rubric

We also refined our evaluation criteria based on real results:

```yaml
assertions:
  - type: llm-rubric
    value: |
      Rate each aspect from 1-10 and provide specific examples:

      1. Brand Harmony:
         - How well do the promptfoo and partner brand elements complement each other?
         - Are there any clashing elements?
         Example: "The red panda's coloring transitions smoothly into NVIDIA's green (9/10)"

      2. Developer Appeal:
         - Would this resonate with our tech audience?
         - Does it avoid clich√©s while remaining relevant?
         Example: "The debugging metaphor is clever without being heavy-handed (8/10)"

      3. Production Viability:
         - Consider both digital and physical reproduction
         - Factor in different shirt colors and sizes
         Example: "Clean lines and distinct color separation make this print-ready (7/10)"
```

### 4. Iterative Improvement

For each design that scored below 40/50, we analyzed the feedback and made targeted improvements:

[Screenshot: Before/after comparison showing how feedback improved specific designs]

## The Results

After several iterations, we arrived at a collection of designs that consistently scored 45+ points on our rubric. The key to success was finding the right balance between brand guidelines and creative expression.

[Screenshot: Final collection of high-scoring designs]

## Want Your Own promptfoo T-Shirt?

We love collaborating with the developer community! Here's how you can get your own promptfoo t-shirt:

1. **Contribute to promptfoo**: Submit PRs, improve documentation, or help other users
2. **Share your eval configs**: Create interesting evaluation examples
3. **Build something cool**: Make something awesome with promptfoo and share it

Check out our [contribution guidelines](https://github.com/promptfoo/promptfoo) to get started. Who knows? Maybe your PR will earn you a t-shirt featuring our coding red panda! üêºüëï

## What's Next?

- Share your own t-shirt designs in our [Discord community](https://discord.gg/promptfoo)
- Help us improve this guide by [submitting suggestions](https://github.com/promptfoo/promptfoo/issues)

Remember, the perfect t-shirt design is just one evaluation away! üöÄ
